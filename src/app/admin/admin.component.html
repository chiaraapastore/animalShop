<div class="container mt-5 mb-5">
  <div class="table-responsive mt-5">
    <h2 class="text-center mb-4">Lista Prodotti</h2>
    <table class="table table-bordered table-hover">
      <thead class="table-dark">
      <tr>
        <th>Immagine</th>
        <th>Nome</th>
        <th>Prezzo (€)</th>
        <th>Quantità</th>
        <th>Categoria</th>
        <th *ngIf="isAdmin">Azioni</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let product of products">
        <td>
          <img [src]="product.imageUrl" class="img-thumbnail" alt="Immagine prodotto">
        </td>
        <td>{{ product.productName }}</td>
        <td>
          <!-- Campo di input per il prezzo -->
          <input type="number" [(ngModel)]="product.price" class="form-control form-control-sm" (blur)="updateProductPrice(product)" />
        </td>
        <td>
          <!-- Campo di input per la quantità -->
          <input type="number" [(ngModel)]="product.availableQuantity" class="form-control form-control-sm" (blur)="updateProductQuantity(product)" />
        </td>
        <td>{{ product.categoryName }}</td>
        <td *ngIf="isAdmin">
          <button (click)="editProduct(product)" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#productModal">Modifica</button>
          <button (click)="deleteProduct(product.id!)" class="btn btn-danger btn-sm">Elimina</button>
        </td>
      </tr>
      </tbody>
    </table>
  </div>

  <div class="text-center mt-5">
    <button class="btn btn-success btn-lg w-50" data-bs-toggle="modal" data-bs-target="#productModal" (click)="openModal()">Aggiungi Prodotto</button>
  </div>

  <!-- Modale per aggiungere e gestire i prodotti -->
  <app-modal
    *ngIf="isModalOpen"
    [products]="products"
    (closeModal)="closeModal()"
    (addProduct)="createProduct()"
    (deleteProducts)="deleteProducts()">
  </app-modal>
</div>
